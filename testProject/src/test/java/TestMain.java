import org.example.Main;
import org.example.UnionFind;
import org.junit.Assert;
import org.junit.Ignore;
import org.junit.jupiter.api.Test;

import java.util.*;

public class TestMain {

    @Test
    @Ignore
    public void initialTest() {
        List values = List.of("\"111\";\"123\";\"222\"",
                "\"200\";\"123\";\"100\"",
                "\"300\";\"\";\"100\"",
                "\"100\";\"200\";\"300\"",
                "\"55\";\"\";\"67\"",
                "\"\";\"99\";\"33\"");
        UnionFind uf = new UnionFind();
        Map<String, Set<String>> groups = new HashMap<>();
        Main.makeUnionFindGroup(uf, values);
        Main.makeListGroup(groups, values, uf);
        //Проверяем, что пустые строки не учавствуют в выборке
        Assert.assertFalse(groups.keySet().stream().anyMatch(key -> key.contains("\"\"")));
        //Проверяем, нужное количество групп
        Assert.assertEquals(4,groups.size());
        //Проверяем корректное разделение элементов по группам
        Assert.assertFalse(groups.values().stream().anyMatch(set -> set.containsAll(List.of(values.get(2),values.get(4)))));
        Assert.assertTrue(groups.values().stream().anyMatch(set -> set.equals(Set.of(values.get(2),values.get(0),values.get(1)))));

    }

    @Test
    @Ignore
    public void simpleTest() {
        List values = List.of("\"79162191646\";\"79941628494\";\"79868500985\";\"\";\"79385613336\";\"79450648876\";\"79350229497\";\"\";\"79389092711\"",
                "\"79448754565\";\"79662521341\";\"79809720225\";\"79046308676\";\"79915766224\";\"79794380754\";\"79957046662\"",
                "\"79990498240\";\"79872061055\";\"79088557729\";\"\";\"79477678872\";\"79670803384\";\"79984449384\";\"79885864948\";\"\";\"79219694755\";\"79910128848\"",
                "\"79203284787\";\"79071488141\";\"79486740384\"",
                "\"79227181405\";\"79811858906\";\"79804670623\";\"79629503088\"",
                "\"79505726194\";\"79811357813\"",
                "\"79166049564\";\"79493851677\";\"\";\"79623021139\";\"79031780521\";\"79045158403\";\"79849007959\";\"79604448878\"",
                "\"\";\"\";\"79497041436\";\"79120995660\";\"79141549838\";\"79287965952\";\"79330916436\"",
                "\"79695984537\";\"79516433533\";\"79220563449\";\"79097243214\";\"79140327480\";\"79214614448\";\"79354375906\"",
                "\"79957521650\";\"\";\"79149581470\";\"\"",
                "\"79894438346\";\"79256688086\"",
                "\"79943808411\";\"79807213683\";\"79210744609\";\"\";\"\"",
                "\"\";\"79547690969\";\"\";\"79155257126\";\"79902440646\";\"\";\"\";\"79838806658\";\"79226634232\";\"79647174357\"",
                "\"79864505300\";\"79985711844\";\"79867830836\";\"79802584409\";\"79638344139\";\"79394524964\";\"79431729077\";\"79893674298\";\"79232098579\"",
                "\"79476910360\";\"79599954689\";\"79936613604\";\"79535407740\";\"79377791198\"",
                "\"79290036045\";\"79713710015\";\"79233616730\";\"79320664347\";\"79336061484\";\"79682231369\";\"79560242007\"",
                "\"79104343575\";\"\";\"79492134020\";\"79071266802\";\"79732790147\";\"79926276820\";\"79540467873\";\"79840443467\";\"79473255569\";\"79702379063\"",
                "\"79660950270\";\"\";\"79960891096\";\"79055331850\";\"79400408706\";\"79345721681\";\"79439473510\"",
                "\"79265829168\";\"79306722226\";\"79744459515\";\"79140461274\"",
                "\"79981630450\";\"79758272667\";\"79120915108\"",
                "\"79618149279\";\"\";\"79598703223\";\"79000492861\";\"79990486488\";\"79618084441\";\"79246943211\";\"79285232675\";\"79676485685\";\"79319144861\"",
                "\"79759336693\";\"79179354956\";\"79017602912\";\"79528738178\";\"79390529551\";\"79642129531\";\"79993384791\"",
                "\"\";\"79341745744\";\"79769565728\";\"79166701293\";\"79697549799\";\"79646788827\";\"\";\"79209717611\";\"79819206366\"",
                "\"79342047876\";\"79139121411\";\"\";\"79964261115\";\"79044192986\";\"79006178876\"",
                "\"79103920002\";\"79037052566\";\"79085288526\";\"79409273907\";\"79549288918\";\"79282678978\";\"79080926382\";\"79876026091\";\"79907417791\";\"79294875453\";\"79154817151\"",
                "\"79548450068\";\"79086606058\";\"79400283360\";\"79965637253\";\"79510936304\";\"79759920605\"",
                "\"\";\"79659398379\";\"79255046633\";\"79684684927\"",
                "\"79486607597\";\"79621719362\";\"79889794352\";\"79502228071\";\"79232858003\"",
                "\"79224224658\";\"79635138693\";\"79729150403\";\"79965649431\";\"79049643707\";\"79497192376\";\"79996035977\"",
                "\"79990842400\";\"79445959611\";\"79472547502\";\"79428993349\";\"79581759338\";\"79457058907\";\"79521421044\"",
                "\"79841322265\";\"\";\"79150408704\";\"\";\"79322599582\";\"\"",
                "\"79748548018\";\"79614904049\";\"79260826294\";\"79693044757\";\"79069259319\";\"79297100430\";\"79113760425\";\"79354051786\"",
                "\"79759000828\";\"79270716380\";\"79975036823\";\"79879829588\";\"79507897466\";\"79808962902\";\"79390505491\";\"79283296081\";\"79910904851\";\"79155487121\"",
                "\"79202620782\";\"79519359516\";\"79951078991\";\"\";\"79515293674\";\"79261025701\";\"79737228272\"",
                "\"\";\"79518219082\";\"79213829078\";\"79271111175\"",
                "\"79293824040\";\"79037858247\";\"79543652885\";\"79820799195\";\"79400165690\";\"79738194747\";\"79585404639\";\"79580060961\";\"79827557236\"",
                "\"79420995524\";\"79359132272\";\"79250231900\";\"79446050810\";\"79736383867\";\"79624197042\";\"79182819173\"",
                "\"79024073826\";\"79449327323\";\"\";\"79502161250\";\"79829273681\";\"79911173971\";\"79315806612\";\"79341410265\"",
                "\"79244687218\";\"79882569036\";\"79740244147\";\"79306001883\";\"\";\"79540317089\";\"79893006491\";\"79525394323\";\"79551019204\";\"79175631025\";\"79043546004\"",
                "\"79312076602\";\"79487933895\";\"79679926044\";\"79234170505\"",
                "\"\";\"79730666137\";\"79957532176\";\"79390990247\";\"79745105696\";\"\";\"\";\"79827247462\";\"79090090380\";\"79906397811\"",
                "\"79038907617\";\"79411164305\";\"79311563547\";\"79639212796\";\"79209870864\";\"79778569558\";\"79716011286\";\"79582267782\"",
                "\"79448088974\";\"79136310060\";\"79399078949\";\"79857207865\";\"79642794523\";\"79582898324\"",
                "\"79308662261\";\"79379626959\";\"79776506499\"",
                "\"79477425073\";\"79223210452\";\"79568098752\";\"79365033703\"",
                "\"79552185461\";\"79482531511\";\"\";\"79494837372\";\"79440431939\";\"79267939321\"",
                "\"79525864993\";\"79495404393\";\"79926775730\";\"79371591980\";\"79798589130\";\"79417275207\";\"79525669963\";\"79198370382\";\"79209427345\"",
                "\"79476307811\";\"79767519509\";\"79453893019\";\"79734277308\";\"79328359116\";\"79915941167\";\"\";\"79160183775\";\"79901959256\";\"79255513678\";\"\"",
                "\"79180514144\";\"79940787749\";\"\";\"79530609187\";\"79185291307\";\"\";\"79071635387\";\"79858135773\";\"79376665476\"",
                "\"79446602460\";\"79942730532\";\"79078496070\"",
                "\"\";\"79233154152\";\"79782738741\";\"79511658121\";\"\";\"79083739957\";\"\";\"79702199009\";\"79751005116\";\"79898916316\";\"79625538966\"",
                "\"79812258939\";\"79345540174\";\"79143598886\";\"79446894209\";\"79372273344\";\"79978446689\";\"79701158816\"",
                "\"79405006042\";\"79270991949\";\"79740900066\";\"79108310785\";\"79559135841\";\"79390055162\";\"\";\"79727927373\";\"79852397405\";\"79860453414\"",
                "\"79427142364\";\"79607582722\";\"79763040371\";\"\";\"79517785422\";\"79421287360\";\"79761807179\";\"\"",
                "\"79624166213\";\"79400581546\";\"79234804684\";\"79435454245\";\"79816991938\";\"79565733997\";\"79956742992\";\"79802467381\";\"79986716905\"",
                "\"79050969516\";\"79289450093\"",
                "\"79425879649\";\"79704869374\";\"79166849478\";\"79285034787\";\"79839709107\"",
                "\"79468164460\";\"79352682173\";\"79854345053\";\"79943198208\"",
                "\"79156932629\";\"79698076959\";\"79576501146\";\"79358335799\";\"79798296408\";\"79129598204\";\"79049505397\";\"79970057326\";\"79169252343\";\"79360175872\"",
                "\"79442084786\";\"79871779578\";\"79024813516\";\"79948928430\";\"79156923004\";\"\";\"79530559412\"",
                "\"79563647017\";\"\";\"79765437507\";\"79503099614\";\"79375420905\";\"79831451463\";\"79624258545\";\"79849557555\";\"79527840630\";\"79261710407\"",
                "\"79833565978\";\"79510647306\";\"79373825395\";\"\";\"79607594347\";\"79478452495\";\"\";\"79318686220\";\"79268571904\";\"79096383804\"",
                "\"79505137908\";\"\";\"79838738533\"",
                "\"79846900047\";\"79671224479\";\"79110894314\";\"79279111353\"",
                "\"79951413713\";\"\";\"79858128327\";\"79362188919\";\"79643801836\";\"79834330203\";\"79064896005\";\"79885958030\";\"79712708000\";\"\";\"79716283215\"",
                "\"79368289265\";\"79497780341\"",
                "\"79643988478\";\"79479069612\";\"79468048964\"",
                "\"79970910895\";\"79759483727\";\"79538320849\";\"79046972805\";\"79986545785\"",
                "\"79302538617\";\"79105557611\";\"79699164975\";\"\";\"79746257767\";\"79157598233\";\"79133699527\";\"79068633926\";\"\";\"79627391612\";\"79587741783\"",
                "\"\";\"79828902349\";\"79482074776\";\"79255135074\";\"79868562330\";\"79127794331\";\"79261358261\";\"79182604298\";\"79579087275\"",
                "\"79268618955\";\"79995269701\";\"79444986932\";\"79927493288\";\"79852833262\";\"79797078438\";\"\";\"79791225637\";\"79174444555\";\"79892520432\"",
                "\"79010150025\";\"79642877236\";\"79265473878\"",
                "\"79077768572\";\"79188553873\";\"79254761762\";\"79058956840\";\"\";\"79969585105\"",
                "\"\";\"79011118933\";\"79154675106\";\"79270291366\";\"\";\"\";\"79158137336\";\"79101099990\";\"79495987187\";\"79348727166\";\"79243530641\"",
                "\"79110130309\";\"79521982965\";\"79736320940\";\"79001975408\";\"79710856056\"",
                "\"79872020482\";\"79902193746\";\"79502817256\";\"\";\"79809890951\";\"79186971831\"",
                "\"79865312398\";\"79405646523\";\"79127306392\"",
                "\"79843923104\";\"79797863993\";\"79610584283\";\"\";\"79715562258\";\"79253929157\";\"79259173957\";\"79921903660\";\"79123643293\";\"79413531892\"",
                "\"79551288152\";\"79170188668\";\"79205573033\";\"79145068074\";\"\"",
                "\"79130902497\";\"79266930704\";\"79679972092\";\"\";\"79883372592\";\"79189036698\";\"79940903507\";\"79793772462\";\"79180356022\"",
                "\"79287184333\";\"79940265797\";\"79662063692\";\"79689521390\";\"79853620507\";\"79594952637\"",
                "\"79348316763\";\"79284331567\";\"79300017330\";\"79946418278\";\"79053391224\"",
                "\"79434097332\";\"79639535237\";\"79092315498\";\"79505080886\";\"79619444724\";\"79463584672\"",
                "\"79388858618\";\"79616790918\"",
                "\"79306925353\";\"79783395096\";\"79464282624\";\"79794225240\"",
                "\"79549176055\";\"\"",
                "\"79334613580\";\"79444302753\";\"79807591580\";\"79982722043\";\"79461683350\";\"79822763031\"",
                "\"\";\"79600014153\";\"79905144725\"",
                "\"79860462337\";\"79137740881\";\"79681553527\";\"\";\"79166512982\";\"79494419107\";\"79195981736\";\"\"",
                "\"79035471341\";\"79994413450\";\"\";\"\";\"79599768970\"",
                "\"79099302602\";\"79191005343\";\"79497802934\";\"79035016088\";\"79848409606\";\"\";\"79295711976\";\"79940047372\";\"79791451953\";\"79553240373\"",
                "\"79634088612\";\"79679461776\"",
                "\"79115212576\";\"\";\"79994845597\";\"79295887324\";\"79245623081\";\"79257643148\"",
                "\"79432748722\";\"79898771128\";\"79696506355\";\"79547781002\";\"79313073955\";\"79623155492\";\"79201282000\";\"79069644034\";\"79836667785\"",
                "\"79911706583\";\"79002544137\";\"79971501732\";\"79800964280\";\"79432601721\";\"79870879069\";\"79595656343\";\"79816447154\";\"79868516650\"",
                "\"79435371591\";\"\";\"79296083165\";\"79918581386\";\"79419579961\";\"79887743206\"",
                "\"79289337263\";\"79959789053\";\"79634500542\";\"79932087636\";\"79798250152\"",
                "\"79798730489\";\"79363142130\";\"79691314282\";\"\";\"79623116755\";\"79851973409\";\"79651055639\";\"79483842506\";\"79194934245\"",
                "\"79199896401\";\"79220647910\";\"79750446882\";\"79749883837\";\"79570932111\";\"79491942212\";\"79375042063\"",
                "\"79071879486\";\"79187809102\";\"79442894784\"",
                "\"79055510787\";\"79626544788\";\"79865520764\";\"79011286270\";\"79936783080\";\"\";\"\";\"79300373452\";\"79410640744\";\"79879651429\";\"79090552916\"",
                "\"\";\"\";\"79665443868\";\"79817049148\"",
                "\"79026497953\";\"79813809430\";\"79682066778\";\"79576698408\";\"79281766229\";\"79451085139\";\"79421801560\"",
                "\"79799034182\";\"79650496337\";\"79268461146\"",
                "\"79992415132\";\"79829310321\";\"79240134090\";\"79802859262\";\"\"",
                "\"79227124856\";\"79642270817\";\"79647162646\";\"79955838073\";\"79073688730\";\"79115847741\";\"79097733160\";\"79505658843\";\"79968855113\"",
                "\"79737851913\";\"79085191225\";\"79605707200\";\"79143615087\";\"79916489498\"",
                "\"79561611199\";\"\";\"79922357982\";\"\"",
                "\"79970248653\";\"79115416185\";\"79178685377\"",
                "\"79548534649\";\"79751061646\";\"79621533107\";\"79117181587\";\"79253296913\"",
                "\"79458934525\";\"\";\"79079505985\";\"79081420312\";\"79578836603\";\"79970922322\";\"79142392657\";\"79017579327\"",
                "\"79182477110\";\"79638448775\";\"79676840808\";\"79495937626\";\"79435500693\";\"79885264434\"",
                "\"79978482533\";\"79946850792\";\"79466413489\";\"79833555345\"",
                "\"79384678585\";\"79112077640\";\"79971894199\";\"79358523510\";\"79704740856\";\"79120037390\";\"79503736608\";\"79157571055\";\"\";\"79860400060\"",
                "\"79178256423\";\"79620463360\";\"79413263696\";\"79386460815\"",
                "\"79649748899\";\"79511848686\";\"79043267176\";\"79680512483\";\"79577215641\"",
                "\"79979942718\";\"79713245694\";\"79135056052\";\"79420842058\";\"79269635849\";\"79629311666\";\"79610217518\"",
                "\"79708902640\";\"79876345648\";\"79932499736\"",
                "\"79711481555\";\"79995319451\"",
                "\"79400441282\";\"79577254329\"",
                "\"79292095774\";\"79620992871\";\"79800166563\";\"79468767489\"",
                "\"\";\"79358024832\";\"79862578645\";\"79300539410\";\"79388191381\"",
                "\"79624477767\";\"79451249347\";\"79216021316\";\"\";\"79015844650\"",
                "\"79506413353\";\"79188645611\";\"79834509506\";\"79620409858\";\"79998608729\";\"79952169115\";\"79285476009\";\"79677770973\";\"79804533203\";\"79927551498\";\"\"",
                "\"\";\"\";\"79657839508\";\"\";\"79777273180\";\"79776303131\";\"79765546521\";\"79649124527\"",
                "\"79903234284\";\"79267325475\"",
                "\"79189908475\";\"79603282103\";\"79153290964\";\"79718356677\";\"\";\"79379967054\";\"79344683325\";\"79008656065\"",
                "\"79056572603\";\"79011973652\";\"79528781279\";\"79677481463\";\"\";\"79454724570\";\"79757592687\";\"79201782119\";\"79160030142\";\"79762414966\"",
                "\"79190662455\";\"79093715875\"",
                "\"79406627243\";\"79729039843\";\"\"",
                "\"\";\"79779221245\"");
        UnionFind uf = new UnionFind();
        Map<String, Set<String>> groups = new HashMap<>();
        Main.makeUnionFindGroup(uf, values);
        Main.makeListGroup(groups, values, uf);
        Assert.assertEquals(groups.size(), values.size());
    }
}
